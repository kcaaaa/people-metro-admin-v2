@echo off
setlocal enabledelayedexpansion

echo.
echo =================================================================
echo  ğŸš‡ äººæ°‘åŸè½¨2.0 - GitHub Pages è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬
echo =================================================================
echo.
echo æ­¤è„šæœ¬å°†æ‰§è¡Œä»¥ä¸‹æ“ä½œ:
echo   1. æäº¤æ‰€æœ‰æœ¬åœ°æ›´æ”¹åˆ° 'main' åˆ†æ”¯
echo   2. å°†å½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶å¼ºåˆ¶æ¨é€åˆ° 'gh-pages' åˆ†æ”¯ç”¨äºéƒ¨ç½²
echo.

:: --- æ­¥éª¤ 1: æäº¤æºç åˆ° main åˆ†æ”¯ ---
echo [æ­¥éª¤ 1/2] æ­£åœ¨æäº¤æºç åˆ° 'main' åˆ†æ”¯...
git add .
git commit -m "chore: automated deployment update"
echo.
echo æ¨é€ 'main' åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“...
git push origin main
if !errorlevel! equ 0 (
    echo   - 'main' åˆ†æ”¯å·²æˆåŠŸæ›´æ–°ã€‚
) else (
    echo   - 'main' åˆ†æ”¯æ¨é€å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–æƒé™ã€‚
)

echo.

:: --- æ­¥éª¤ 2: éƒ¨ç½²åˆ° gh-pages åˆ†æ”¯ ---
echo [æ­¥éª¤ 2/2] æ­£åœ¨å°†é¡¹ç›®éƒ¨ç½²åˆ° 'gh-pages' åˆ†æ”¯...

:: ä½¿ç”¨ subtree å¼ºåˆ¶å°†å½“å‰ç›®å½•éƒ¨ç½²åˆ° gh-pages åˆ†æ”¯
:: è¿™ä¼šåˆ›å»ºä¸€ä¸ªå¹²å‡€çš„ã€åªåŒ…å«é¡¹ç›®æ–‡ä»¶çš„åˆ†æ”¯ï¼Œéå¸¸é€‚åˆéƒ¨ç½²
git subtree push --prefix=. origin gh-pages

if !errorlevel! equ 0 (
    echo.
    echo =================================================================
    echo  ğŸ‰ éƒ¨ç½²æˆåŠŸ!
    echo =================================================================
    echo.
    echo  - ä½ çš„ç½‘ç«™æ­£åœ¨æ›´æ–°ä¸­ï¼Œè¯·ç­‰å¾…1-2åˆ†é’Ÿã€‚
    echo  - è®¿é—®åœ°å€: https://kcaaaa.github.io/people-metro-admin-v2/
    echo.
    echo  - [é‡è¦æç¤º] è¯·ç¡®ä¿ä½ çš„ GitHub Pages è®¾ç½®æ­£ç¡®:
    echo    - ä»“åº“ -> Settings -> Pages
    echo    - Source: Deploy from a branch
    echo    - Branch: gh-pages
    echo    - Folder: /(root)
    echo.
) else (
    echo.
    echo =================================================================
    echo  âŒ éƒ¨ç½²å¤±è´¥!
    echo =================================================================
    echo.
    echo  - åŸå› : 'git subtree push' å‘½ä»¤æ‰§è¡Œå¤±è´¥ã€‚
    echo  - è¯·æ£€æŸ¥ Git æ˜¯å¦å®‰è£…æ­£ç¡®ï¼Œä»¥åŠæ˜¯å¦æœ‰è¿œç¨‹ä»“åº“çš„æ¨é€æƒé™ã€‚
    echo.
)

pause
