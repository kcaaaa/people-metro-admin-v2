# 栏目管理功能需求文档 (FRD)

**版本**: v1.0  
**日期**: 2024-01-15  
**负责人**: 产品经理  
**项目**: 人民城轨2.0运营平台  

> 本文档旨在详细定义"栏目管理"功能模块的需求。本文档将作为研发、测试和设计团队的工作依据，确保各方对栏目管理功能有统一、清晰的理解。

---

## 一、功能概述

### 1.1 功能背景
随着内容发布板块的调整，平台需要支持选择不同的发布栏目。每个栏目需要可以配置权限（发布人、审核人）等，以满足不同栏目的内容管理需求。

### 1.2 功能目标
- 建立完整的栏目管理体系，支持主栏目和子栏目的层级管理
- 为每个栏目配置独立的权限控制，包括发布权限和审核权限
- 提供灵活的权限配置模板，支持快速应用和批量配置
- 实现权限冲突检测和变更历史追踪，确保权限配置的合规性

### 1.3 功能范围
- 栏目基础管理（增删改查、状态管理、排序）
- 栏目权限配置（发布权限、审核权限、发布设置）
- 权限模板管理（模板定义、快速应用、批量配置）
- 权限冲突检测和变更历史追踪

---

## 二、功能结构

### 2.1 功能模块图
```
栏目管理
├── 栏目基础管理
│   ├── 栏目树形展示
│   ├── 栏目增删改查
│   ├── 栏目状态管理
│   └── 栏目排序调整
├── 栏目权限管理
│   ├── 发布权限配置
│   ├── 审核权限配置
│   ├── 发布设置配置
│   └── 权限冲突检测
├── 权限模板管理
│   ├── 权限模板定义
│   ├── 模板快速应用
│   └── 批量模板配置
└── 权限监控追踪
    ├── 权限变更历史
    ├── 权限使用统计
    └── 权限合规检查
```

### 2.2 栏目层级结构
```
关于我们 (主栏目)
├── 协会简介 (子栏目)
├── 协会章程 (子栏目)
├── 党建园地 (子栏目)
├── 4+N 纲领性文件 (子栏目)
└── 品牌活动 (子栏目)

资讯 (主栏目)
├── 行业资讯 (子栏目)
└── 协会信息 (子栏目)

服务 (主栏目)
├── 会员服务 (子栏目)
├── 统计 (子栏目)
├── 标准 (子栏目)
├── 人才培养 (子栏目)
├── 评审 (子栏目)
└── 政策汇编 (子栏目)

专栏 (主栏目)
├── 口述历史 (子栏目)
├── 解密 (子栏目)
├── 人物 (子栏目)
├── 城轨科普 (子栏目)
└── 地铁之美 (子栏目)
```

---

## 三、功能详细描述

### 3.1 栏目基础管理

#### 3.1.1 栏目树形展示
**功能描述**: 以树形结构展示所有栏目，支持展开/收起、选择、搜索等操作。

**功能字段**:
- 栏目名称 (title): 栏目的显示名称
- 栏目代码 (code): 栏目的唯一标识符
- 栏目层级 (level): 1=主栏目，2=子栏目
- 排序权重 (sort): 数字越小排序越靠前
- 栏目状态 (status): enabled=启用，disabled=禁用
- 内容数量 (contentCount): 该栏目下的内容数量
- 上级栏目 (parentKey): 子栏目的父级栏目标识

**交互效果**:
- 支持点击展开/收起栏目
- 支持选择单个或多个栏目
- 支持搜索栏目名称或代码
- 显示栏目的内容数量和状态标签

#### 3.1.2 栏目增删改查
**功能描述**: 支持创建、编辑、删除栏目，以及查看栏目详细信息。

**新增栏目**:
- 选择上级栏目（可选，留空表示创建主栏目）
- 输入栏目名称（必填）
- 输入栏目代码（必填，建议使用英文和数字）
- 输入栏目描述（可选）
- 设置排序权重（可选，默认1）

**编辑栏目**:
- 修改栏目名称、代码、描述
- 调整排序权重
- 更改栏目状态（启用/禁用）

**删除栏目**:
- 检查栏目下是否有内容
- 确认删除操作
- 级联删除子栏目（如果存在）

#### 3.1.3 栏目状态管理
**功能描述**: 控制栏目的启用/禁用状态，影响内容的发布和展示。

**状态类型**:
- 启用 (enabled): 栏目正常使用，可以发布和展示内容
- 禁用 (disabled): 栏目暂停使用，不能发布新内容，已有内容可选择隐藏

**状态切换规则**:
- 禁用主栏目时，自动禁用其下所有子栏目
- 启用主栏目时，子栏目状态保持不变
- 状态变更需要记录操作日志

#### 3.1.4 栏目排序调整
**功能描述**: 通过调整排序权重来控制栏目在列表中的显示顺序。

**排序规则**:
- 数字越小排序越靠前
- 支持拖拽调整顺序
- 同级栏目间排序独立
- 排序变更实时生效

### 3.2 栏目权限管理

#### 3.2.1 发布权限配置
**功能描述**: 配置哪些角色和用户可以在此栏目发布内容。

**权限类型**:
- 角色权限: 基于用户角色的权限控制
- 用户权限: 针对特定用户的权限控制

**支持角色**:
- 内容编辑 (content_editor): 基础内容编辑权限
- 栏目管理员 (column_manager): 栏目管理权限
- 高级编辑 (senior_editor): 高级内容编辑权限
- 特邀编辑 (guest_editor): 特邀编辑权限

**权限验证逻辑**:
- 用户具有任一发布角色即可发布
- 用户被明确授权也可发布
- 角色权限和用户权限为"或"的关系

#### 3.2.2 审核权限配置
**功能描述**: 配置哪些角色和用户可以审核此栏目的内容。

**支持角色**:
- 内容审核员 (content_reviewer): 基础内容审核权限
- 高级审核员 (senior_reviewer): 高级内容审核权限
- 内容管理员 (content_manager): 内容管理权限
- 总编辑 (chief_editor): 最高审核权限

**权限验证逻辑**:
- 用户具有任一审核角色即可审核
- 用户被明确授权也可审核
- 审核权限独立于发布权限

#### 3.2.3 发布设置配置
**功能描述**: 配置栏目的发布行为，包括自动发布和审核要求。

**自动发布**:
- 启用: 符合条件的内容自动发布，无需人工审核
- 禁用: 所有内容必须经过审核才能发布

**强制审核**:
- 启用: 所有内容必须经过审核
- 禁用: 允许自动发布

**设置组合**:
- 严格模式: 自动发布=禁用，强制审核=启用
- 适中模式: 自动发布=禁用，强制审核=启用
- 宽松模式: 自动发布=启用，强制审核=禁用

#### 3.2.4 权限冲突检测
**功能描述**: 检测权限配置中的潜在冲突和问题。

**冲突类型**:
- 用户冲突: 同一用户同时具有发布和审核权限
- 逻辑冲突: 启用自动发布但要求审核
- 权限重叠: 角色权限和用户权限重复

**冲突处理**:
- 显示冲突详情和严重程度
- 提供解决建议
- 允许强制保存（需确认）

### 3.3 权限模板管理

#### 3.3.1 权限模板定义
**功能描述**: 预定义常用的权限配置模板，支持快速应用。

**模板类型**:
- 严格模式: 所有内容必须经过审核，仅允许特定角色发布
- 适中模式: 大部分内容需要审核，允许编辑角色发布
- 宽松模式: 允许自动发布，仅对敏感内容进行审核

**模板内容**:
- 发布角色列表
- 审核角色列表
- 发布设置配置
- 模板描述和适用场景

#### 3.3.2 模板快速应用
**功能描述**: 一键应用权限模板到指定栏目。

**应用流程**:
- 选择要应用模板的栏目
- 选择权限模板
- 预览模板配置
- 确认应用（覆盖现有配置）

**应用规则**:
- 模板会完全覆盖现有权限配置
- 应用后不可撤销（可通过历史记录查看）
- 记录模板应用操作日志

#### 3.3.3 批量模板配置
**功能描述**: 批量将权限模板应用到多个栏目。

**批量操作**:
- 选择多个栏目
- 选择权限模板
- 批量应用配置
- 显示操作结果统计

**操作限制**:
- 单次最多处理50个栏目
- 支持按栏目类型筛选
- 提供操作进度提示

### 3.4 权限监控追踪

#### 3.4.1 权限变更历史
**功能描述**: 记录和追踪所有权限配置的变更历史。

**历史记录内容**:
- 变更时间
- 操作人员
- 变更原因
- 变更前后的配置对比
- 变更类型（手动配置/模板应用）

**历史查看**:
- 按栏目查看变更历史
- 按时间范围筛选
- 按操作人员筛选
- 支持历史记录导出

#### 3.4.2 权限使用统计
**功能描述**: 统计和分析权限配置的使用情况。

**统计维度**:
- 各权限模式的使用数量
- 角色权限的分配情况
- 用户权限的分配情况
- 权限变更频率分析

**统计展示**:
- 数据概览卡片
- 趋势图表
- 分布饼图
- 排行榜

#### 3.4.3 权限合规检查
**功能描述**: 检查权限配置是否符合安全合规要求。

**检查项目**:
- 权限分离原则检查
- 最小权限原则检查
- 权限变更审批检查
- 敏感操作权限检查

**检查结果**:
- 合规状态标识
- 问题详情说明
- 整改建议
- 定期合规报告

---

## 四、功能交互逻辑

### 4.1 权限配置流程

#### 4.1.1 单个栏目权限配置
```
1. 选择栏目
2. 点击"配置权限"按钮
3. 打开权限配置模态框
4. 配置发布权限（角色+用户）
5. 配置审核权限（角色+用户）
6. 配置发布设置（自动发布+强制审核）
7. 系统检测权限冲突
8. 如有冲突，显示冲突详情
9. 用户选择解决冲突或强制保存
10. 保存权限配置
11. 更新栏目权限状态
12. 记录操作日志
```

#### 4.1.2 权限模板应用流程
```
1. 选择栏目
2. 点击"应用模板"按钮
3. 打开模板选择模态框
4. 查看模板详情和配置
5. 选择要应用的模板
6. 系统应用模板配置
7. 更新栏目权限
8. 记录模板应用日志
9. 显示应用成功提示
```

### 4.2 权限验证流程

#### 4.2.1 发布权限验证
```
1. 用户尝试发布内容到指定栏目
2. 系统获取栏目权限配置
3. 检查用户角色是否在发布角色列表中
4. 检查用户是否在发布用户列表中
5. 任一条件满足即可发布
6. 记录权限验证日志
```

#### 4.2.2 审核权限验证
```
1. 用户尝试审核指定栏目的内容
2. 系统获取栏目权限配置
3. 检查用户角色是否在审核角色列表中
4. 检查用户是否在审核用户列表中
5. 任一条件满足即可审核
6. 记录权限验证日志
```

### 4.3 权限冲突处理流程

#### 4.3.1 冲突检测流程
```
1. 用户配置权限后点击保存
2. 系统执行权限冲突检测
3. 检查用户权限重叠
4. 检查逻辑配置冲突
5. 生成冲突报告
6. 如有冲突，显示冲突详情
7. 用户选择解决方式
8. 系统执行相应处理
```

#### 4.3.2 冲突解决方式
```
1. 自动解决: 系统自动调整配置
2. 手动修改: 用户手动调整配置
3. 强制保存: 用户确认后强制保存
4. 取消操作: 用户取消本次配置
```

---

## 五、数据流向图

### 5.1 权限配置数据流
```
用户操作 → 前端表单 → 权限验证 → 冲突检测 → 数据保存 → 权限更新 → 缓存刷新
    ↓           ↓         ↓         ↓         ↓         ↓         ↓
权限配置界面 → 表单数据 → 验证结果 → 冲突报告 → 数据库 → 权限状态 → 界面更新
```

### 5.2 权限验证数据流
```
内容操作 → 权限检查 → 权限配置 → 角色验证 → 用户验证 → 权限结果 → 操作执行
    ↓         ↓         ↓         ↓         ↓         ↓         ↓
发布/审核 → 栏目标识 → 权限数据 → 角色匹配 → 用户匹配 → 允许/拒绝 → 继续/阻止
```

---

## 六、业务流程图

### 6.1 栏目权限管理主流程
```
开始
  ↓
加载栏目数据
  ↓
显示栏目树形结构
  ↓
用户选择栏目
  ↓
显示栏目详情
  ↓
用户选择操作类型
  ↓
┌─────────────────┬─────────────────┬─────────────────┐
│   配置权限      │   应用模板      │   查看历史      │
│       ↓         │       ↓         │       ↓         │
│   权限配置      │   模板选择      │   历史记录      │
│       ↓         │       ↓         │       ↓         │
│   冲突检测      │   模板应用      │   记录详情      │
│       ↓         │       ↓         │       ↓         │
│   保存配置      │   更新权限      │   关闭抽屉      │
└─────────────────┴─────────────────┴─────────────────┘
  ↓
更新界面显示
  ↓
结束
```

### 6.2 权限配置详细流程
```
开始配置权限
  ↓
加载当前权限配置
  ↓
显示权限配置表单
  ↓
用户修改权限设置
  ↓
点击保存按钮
  ↓
表单数据验证
  ↓
权限冲突检测
  ↓
┌─────────────┬─────────────┐
│   有冲突    │   无冲突    │
│      ↓      │      ↓      │
│   显示冲突  │   保存配置  │
│      ↓      │      ↓      │
│   用户处理  │   更新权限  │
│      ↓      │      ↓      │
│   重新检测  │   保存成功  │
└─────────────┴─────────────┘
  ↓
关闭配置窗口
  ↓
刷新权限显示
  ↓
结束
```

---

## 七、功能时序图

### 7.1 权限配置时序图
```
用户        前端界面        权限管理器        数据库
 │            │              │              │
 │──选择栏目──→│              │              │
 │            │──获取权限──→│              │
 │            │              │──查询权限──→│
 │            │              │←──权限数据──│
 │            │←──权限数据──│              │
 │            │              │              │
 │──修改权限──→│              │              │
 │            │──保存权限──→│              │
 │            │              │──冲突检测──→│
 │            │              │←──检测结果──│
 │            │←──检测结果──│              │
 │            │              │              │
 │──确认保存──→│              │              │
 │            │──更新权限──→│              │
 │            │              │──保存权限──→│
 │            │              │←──保存结果──│
 │            │←──更新结果──│              │
 │            │              │              │
 │            │──刷新界面──→│              │
 │            │              │              │
```

### 7.2 权限验证时序图
```
用户        内容系统        权限管理器        权限配置
 │            │              │              │
 │──发布内容──→│              │              │
 │            │──权限检查──→│              │
 │            │              │──获取配置──→│
 │            │              │←──配置数据──│
 │            │              │              │
 │            │              │──验证权限──→│
 │            │              │←──验证结果──│
 │            │←──权限结果──│              │
 │            │              │              │
 │            │──执行操作──→│              │
 │            │              │              │
```

---

## 八、异常处理机制

### 8.1 权限配置异常

#### 8.1.1 数据验证异常
**异常类型**: 表单数据格式不正确
**处理方式**: 
- 显示具体错误信息
- 高亮错误字段
- 阻止表单提交
- 提供修正建议

#### 8.1.2 权限冲突异常
**异常类型**: 检测到权限配置冲突
**处理方式**:
- 显示冲突详情
- 提供解决建议
- 允许用户选择处理方式
- 记录冲突处理日志

#### 8.1.3 保存失败异常
**异常类型**: 权限配置保存到数据库失败
**处理方式**:
- 显示错误提示
- 保留用户输入数据
- 提供重试选项
- 记录错误日志

### 8.2 权限验证异常

#### 8.2.1 权限配置缺失
**异常类型**: 栏目权限配置不存在
**处理方式**:
- 使用默认权限配置
- 记录配置缺失日志
- 通知管理员处理
- 阻止相关操作

#### 8.2.2 权限验证超时
**异常类型**: 权限验证响应超时
**处理方式**:
- 使用缓存权限配置
- 记录超时日志
- 显示警告信息
- 允许用户重试

### 8.3 系统异常

#### 8.3.1 服务不可用
**异常类型**: 权限管理服务暂时不可用
**处理方式**:
- 显示服务状态提示
- 使用本地缓存数据
- 提供离线操作模式
- 自动重试连接

#### 8.3.2 数据不一致
**异常类型**: 权限配置数据不一致
**处理方式**:
- 显示数据状态提示
- 提供数据同步选项
- 记录不一致日志
- 通知管理员处理

---

## 九、性能要求

### 9.1 响应时间要求
- 栏目树加载: ≤ 2秒
- 权限配置保存: ≤ 1秒
- 权限验证: ≤ 500毫秒
- 模板应用: ≤ 1秒
- 冲突检测: ≤ 500毫秒

### 9.2 并发处理要求
- 支持100个用户同时进行权限配置
- 支持1000个用户同时进行权限验证
- 支持10000个栏目同时进行权限检查

### 9.3 数据处理要求
- 支持最多1000个栏目
- 支持最多10000个用户权限配置
- 支持最多100000条权限变更历史记录

---

## 十、安全要求

### 10.1 权限控制
- 只有具有栏目管理权限的用户才能配置栏目权限
- 权限配置变更需要记录操作日志
- 敏感权限配置需要二次确认

### 10.2 数据安全
- 权限配置数据需要加密存储
- 权限变更历史需要完整记录
- 敏感操作需要审计日志

### 10.3 访问控制
- 支持IP白名单限制
- 支持操作时间限制
- 支持异常操作告警

---

## 十一、测试要求

### 11.1 功能测试
- 栏目基础管理功能测试
- 权限配置功能测试
- 权限验证功能测试
- 模板应用功能测试
- 冲突检测功能测试

### 11.2 性能测试
- 权限验证性能测试
- 并发处理能力测试
- 大数据量处理测试

### 11.3 安全测试
- 权限绕过测试
- 数据泄露测试
- 操作审计测试

---

## 十二、部署要求

### 12.1 环境要求
- 支持主流浏览器（Chrome、Firefox、Safari、Edge）
- 支持移动端访问
- 支持HTTPS协议

### 12.2 依赖要求
- 需要权限管理系统支持
- 需要用户角色管理系统支持
- 需要日志记录系统支持

### 12.3 监控要求
- 功能使用情况监控
- 性能指标监控
- 异常情况告警

---

## 十三、验收标准

### 13.1 功能验收
- 所有功能模块正常运行
- 权限配置正确生效
- 权限验证准确无误
- 异常情况处理得当

### 13.2 性能验收
- 响应时间满足要求
- 并发处理能力满足要求
- 数据处理能力满足要求

### 13.3 安全验收
- 权限控制有效
- 数据安全保护到位
- 操作审计完整

---

## 十四、后续规划

### 14.1 功能扩展
- 支持更复杂的权限规则配置
- 支持权限继承和委派
- 支持权限模板自定义

### 14.2 性能优化
- 权限验证缓存优化
- 大数据量处理优化
- 并发处理能力提升

### 14.3 用户体验
- 权限配置向导优化
- 权限冲突智能提示
- 权限使用分析报告

---

**文档版本**: v1.0  
**最后更新**: 2024-01-15  
**审核状态**: 待审核  
**下次评审**: 2024-01-20
