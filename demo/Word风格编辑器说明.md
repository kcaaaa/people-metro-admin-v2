# Word风格图片编辑器 - 功能说明

## 📌 核心特性

这是一个完全模仿 **Microsoft Word** 图片编辑功能的富文本编辑器，支持：

### ✨ 核心功能

1. **自由拖拽** 🖱️
   - 点击图片即可拖拽到任意位置
   - 实时显示位置变化
   - 自动限制在编辑器范围内

2. **调整大小** 📏
   - 8个调整手柄（四角 + 四边）
   - 拖拽手柄即可调整大小
   - 保持图片比例或自由调整
   - 最小尺寸限制（50x50px）

3. **6种文字环绕方式** 📝
   - **嵌入型**：图片嵌入文字中，像普通字符一样
   - **四周型**：文字环绕图片四周（float布局）
   - **紧密型**：文字紧密环绕图片轮廓
   - **穿越型**：图片浮动在文字上方
   - **上下型**：图片独占一行，文字在上下
   - **衬于文字下方**：图片作为背景，文字在上方

4. **实时预览** 👁️
   - 左侧编辑，右侧实时预览
   - 所见即所得
   - 完全模拟最终效果

---

## 🎯 使用方法

### 1. 插入图片

```
点击工具栏的图片图标 📷
   ↓
选择本地图片文件
   ↓
图片自动插入到编辑器中
   ↓
默认使用"四周型"环绕方式
```

### 2. 移动图片位置

```
点击图片（不要点击边缘的手柄）
   ↓
按住鼠标左键
   ↓
拖拽到目标位置
   ↓
松开鼠标，位置固定
```

### 3. 调整图片大小

```
点击图片使其被选中（出现蓝色虚线边框）
   ↓
找到8个调整手柄（蓝色圆点）
   - 四角手柄：对角调整
   - 四边手柄：单边调整
   ↓
拖拽手柄调整大小
   ↓
松开鼠标，大小固定
```

### 4. 更改文字环绕方式

```
点击图片使其被选中
   ↓
图片上方出现工具栏
   ↓
点击工具栏中的环绕方式按钮：
   - 嵌入型 ▭
   - 四周型 ▢
   - 紧密型 ⊡
   - 穿越型 ⧉
   - 上下型 ▬
   - 衬于文字下方 ▭
   ↓
环绕方式立即应用
```

### 5. 删除图片

```
点击图片使其被选中
   ↓
点击工具栏中的"删除"按钮 🗑️
   ↓
图片被删除
```

---

## 💡 6种文字环绕方式详解

### 1️⃣ 嵌入型（Inline）

**效果**：图片像普通字符一样嵌入文字中

**适用场景**：
- 图标、表情符号
- 行内小图片
- 需要与文字对齐的图片

**CSS实现**：
```css
.wrap-inline {
    position: relative;
    display: inline-block;
    margin: 0 8px;
}
```

**示例**：
```
这是一段文字 [图片] 这是后续文字
```

---

### 2️⃣ 四周型（Square）

**效果**：文字环绕图片的矩形边界

**适用场景**：
- 最常用的环绕方式
- 图文混排
- 新闻文章配图

**CSS实现**：
```css
.wrap-square {
    float: left;
    margin: 0 16px 16px 0;
}
```

**示例**：
```
[图片在左侧]
文字环绕在图片右侧和下方，
形成矩形的环绕效果。
文字会自动避开图片区域。
```

---

### 3️⃣ 紧密型（Tight）

**效果**：文字紧密环绕图片轮廓（对于矩形图片效果与四周型类似）

**适用场景**：
- 不规则形状的图片
- 需要更紧密排版的场景

**CSS实现**：
```css
.wrap-tight {
    float: left;
    margin: 0 12px 12px 0;
    shape-outside: margin-box;
}
```

---

### 4️⃣ 穿越型（Through）

**效果**：图片浮动在文字上方，文字穿过图片

**适用场景**：
- 水印效果
- 背景装饰图片
- 特殊设计需求

**CSS实现**：
```css
.wrap-through {
    position: absolute;
    z-index: 10;
}
```

**示例**：
```
文字正常排列
[图片浮动在文字上方]
文字继续正常排列
```

---

### 5️⃣ 上下型（Top and Bottom）

**效果**：图片独占一行，文字只在图片上方和下方

**适用场景**：
- 重要图片展示
- 图表、示意图
- 需要突出的配图

**CSS实现**：
```css
.wrap-top-bottom {
    display: block;
    margin: 16px auto;
}
```

**示例**：
```
上方文字

[图片居中显示，独占一行]

下方文字
```

---

### 6️⃣ 衬于文字下方（Behind Text）

**效果**：图片作为背景，文字显示在图片上方

**适用场景**：
- 背景图片
- 页面装饰
- 特殊排版效果

**CSS实现**：
```css
.wrap-behind {
    position: absolute;
    z-index: 1;
}
```

---

## 🎨 界面说明

### 图片选中状态

当图片被选中时，会显示：

1. **蓝色虚线边框**：表示图片被选中
2. **8个调整手柄**：蓝色圆点，用于调整大小
3. **顶部工具栏**：包含环绕方式和删除按钮

### 工具栏按钮

| 按钮 | 图标 | 功能 |
|-----|------|------|
| 嵌入型 | ▭ | 图片嵌入文字中 |
| 四周型 | ▢ | 文字环绕四周 |
| 紧密型 | ⊡ | 文字紧密环绕 |
| 穿越型 | ⧉ | 图片浮动在文字上方 |
| 上下型 | ▬ | 文字只在上下 |
| 衬于文字下方 | ▭ | 图片作为背景 |
| 删除 | 🗑️ | 删除图片 |

---

## 🔧 技术实现

### 核心技术

1. **绝对定位**：使用 `position: absolute` 实现自由拖拽
2. **浮动布局**：使用 `float` 实现文字环绕
3. **事件监听**：监听鼠标事件实现拖拽和调整大小
4. **实时更新**：监听变化实时更新预览区域

### 关键代码

#### 1. 插入图片
```javascript
function insertWordImage(src) {
    // 创建图片包装器
    const wrapper = document.createElement('div');
    wrapper.className = 'word-image-wrapper wrap-square';
    
    // 设置初始位置和大小
    wrapper.style.width = '300px';
    wrapper.style.height = '200px';
    wrapper.style.left = '50px';
    wrapper.style.top = '50px';
    
    // 添加图片、工具栏、调整手柄
    // ...
}
```

#### 2. 拖拽移动
```javascript
wrapper.addEventListener('mousedown', function(e) {
    isDragging = true;
    dragStartX = e.clientX - wrapper.offsetLeft;
    dragStartY = e.clientY - wrapper.offsetTop;
});

document.addEventListener('mousemove', function(e) {
    if (isDragging) {
        let newX = e.clientX - dragStartX;
        let newY = e.clientY - dragStartY;
        wrapper.style.left = newX + 'px';
        wrapper.style.top = newY + 'px';
    }
});
```

#### 3. 调整大小
```javascript
// 8个调整手柄
const handles = ['nw', 'n', 'ne', 'e', 'se', 's', 'sw', 'w'];

// 根据手柄位置调整大小
if (resizeHandle.includes('e')) {
    newWidth = currentWidth + deltaX;
}
if (resizeHandle.includes('s')) {
    newHeight = currentHeight + deltaY;
}
```

---

## 📊 功能对比

### Word风格 vs 传统方式

| 功能 | 传统方式 | Word风格 ⭐ |
|-----|---------|------------|
| 移动图片 | ❌ 不支持 | ✅ 自由拖拽 |
| 调整大小 | ❌ 需要代码 | ✅ 8个手柄 |
| 环绕方式 | 3种 | 6种 |
| 操作方式 | 点击按钮 | 直接拖拽 |
| 精确定位 | ❌ 困难 | ✅ 像素级精确 |
| 用户体验 | 一般 | ⭐⭐⭐⭐⭐ |

---

## 🎯 使用技巧

### 技巧 1：快速定位

1. 拖拽图片到大致位置
2. 使用键盘方向键微调（未来功能）
3. 查看右侧预览确认效果

### 技巧 2：等比例缩放

1. 拖拽四角的手柄
2. 按住 Shift 键（未来功能）
3. 保持图片比例不变

### 技巧 3：文字环绕效果

1. 插入图片后默认使用"四周型"
2. 在图片周围输入文字
3. 文字会自动环绕图片
4. 尝试不同环绕方式看效果

### 技巧 4：多图排版

1. 插入多张图片
2. 分别设置不同的环绕方式
3. 拖拽到合适位置
4. 创建丰富的图文混排效果

---

## 🚀 优势总结

### 1. 操作直观
- **拖拽移动**：像操作 Word 一样自然
- **手柄调整**：可视化调整大小
- **实时反馈**：立即看到效果

### 2. 功能强大
- **6种环绕**：满足各种排版需求
- **精确控制**：像素级定位
- **自由布局**：不受限制

### 3. 用户体验好
- **所见即所得**：实时预览
- **操作流畅**：无卡顿
- **学习成本低**：熟悉的操作方式

---

## 📝 注意事项

1. **图片位置**：使用绝对定位，需要注意与文字的层级关系
2. **性能考虑**：大量图片可能影响性能，建议控制数量
3. **浏览器兼容**：建议使用现代浏览器（Chrome、Firefox、Edge）
4. **保存功能**：当前保存到 localStorage，生产环境应保存到服务器

---

## 🔮 未来扩展

### 可能的功能增强

1. **键盘操作**：
   - 方向键微调位置
   - Shift+拖拽等比例缩放
   - Delete 键删除图片

2. **对齐辅助**：
   - 智能对齐线
   - 吸附功能
   - 均匀分布

3. **图片编辑**：
   - 裁剪
   - 旋转
   - 滤镜效果

4. **批量操作**：
   - 多选图片
   - 批量调整
   - 组合/取消组合

---

## 📞 使用建议

### 适用场景

1. **大屏内容编辑**：编辑大屏展示内容
2. **新闻资讯**：图文并茂的文章
3. **产品介绍**：产品配图和说明
4. **报告文档**：数据图表和分析

### 最佳实践

1. **图片大小**：建议 200-500px 宽度
2. **环绕方式**：常用"四周型"和"上下型"
3. **图片数量**：单页不超过 10 张
4. **定期保存**：避免数据丢失

---

**版本**：v1.0  
**更新时间**：2024年11月  
**开发团队**：人民城轨后台管理系统开发组

