# 分类管理功能设计文档

## 1. 功能概述

分类管理功能用于对AI知识库的分类进行维护，与智能体管理、知识库管理功能平级。该功能允许管理员创建、编辑、删除分类，并设置分类的层级关系。

## 2. 功能需求

### 2.1 核心功能

- **分类树展示**：以树形结构展示所有分类及其层级关系
- **分类增删改查**：支持创建、编辑、删除分类
- **分类层级管理**：支持设置父分类，实现分类的层级结构
- **分类状态管理**：支持启用/禁用分类

### 2.2 权限控制

- 只有管理员可以管理分类（创建、编辑、删除）
- 普通用户只能在"其他"分类下新增知识库

### 2.3 智能体关联

- 智能体可以关联默认分类标签
- 使用智能体时，只能选择该智能体默认分类和"其他"分类下的知识库

## 3. 数据结构

### 3.1 分类数据结构

```json
{
  "id": "category_id",
  "name": "分类名称",
  "parentId": "父分类ID",
  "level": 1, // 分类层级
  "enabled": true, // 分类状态
  "description": "分类描述",
  "createdAt": "2024-01-01",
  "updatedAt": "2024-01-02"
}
```

### 3.2 演示分类结构

```
- 标准
  - 国家标准
  - 行业标准
  - 团体标准
- 统计分析
  - 年报
  - 半年报
- 合规
  - 法律法规
  - 法律条款
- 其他
```

## 4. 界面设计

### 4.1 分类管理主界面

- **布局**：采用Element UI的布局组件，左侧为分类树，右侧为分类详情和操作按钮
- **分类树**：展示所有分类及其层级关系，支持展开/折叠
- **操作按钮**：新增分类、编辑分类、删除分类、刷新分类列表

### 4.2 新增/编辑分类对话框

- **表单字段**：
  - 分类名称（必填）
  - 父分类（可选）
  - 分类描述（可选）
  - 启用状态（开关）
- **验证规则**：
  - 分类名称不能为空
  - 分类名称不能重复

### 4.3 权限控制界面

- **用户权限**：普通用户在新增知识库时，只能选择"其他"分类

## 5. 功能实现

### 5.1 菜单集成

在AI管理子菜单中添加"分类管理"菜单项，与智能体管理、知识库管理功能平级。

### 5.2 组件实现

- 创建`AICategoryManagement.js`组件，实现分类管理功能
- 使用Ant Design的Tree组件展示分类树
- 使用Form组件实现分类的新增/编辑
- 使用Modal组件展示对话框

### 5.3 知识库关联

修改`AIKnowledgeManagement.js`，使用新的分类管理功能：
- 从分类管理系统获取分类数据
- 在新增/编辑知识库时，提供分类选择下拉框
- 限制普通用户只能选择"其他"分类

### 5.4 智能体关联

修改`AIAgentManagement.js`，实现智能体与分类的关联：
- 在智能体数据结构中添加`defaultCategory`字段
- 在新增/编辑智能体时，提供默认分类选择
- 智能体使用时，只能选择默认分类和"其他"分类下的知识库

## 6. 业务流程

### 6.1 分类管理流程

1. 管理员登录系统
2. 进入AI管理 -> 分类管理
3. 查看分类树
4. 执行新增/编辑/删除分类操作
5. 保存分类信息

### 6.2 知识库新增流程

1. 用户登录系统
2. 进入AI管理 -> 知识库管理
3. 点击"新增知识库"
4. 填写知识库信息
5. 选择分类（普通用户只能选择"其他"分类）
6. 保存知识库

### 6.3 智能体使用流程

1. 用户登录系统
2. 进入AI管理 -> 智能体管理
3. 选择智能体
4. 智能体自动关联默认分类
5. 用户只能选择默认分类和"其他"分类下的知识库

## 7. 异常处理

- **分类删除异常**：当分类下有知识库时，不允许删除
- **权限异常**：普通用户尝试在非"其他"分类下新增知识库时，给出权限不足提示
- **数据加载异常**：分类数据加载失败时，给出错误提示

## 8. 测试用例

### 8.1 分类管理测试

- 测试分类的增删改查功能
- 测试分类层级关系的设置
- 测试分类状态的启用/禁用

### 8.2 权限控制测试

- 测试普通用户只能在"其他"分类下新增知识库
- 测试管理员可以在所有分类下新增知识库

### 8.3 智能体关联测试

- 测试智能体与默认分类的关联
- 测试智能体只能选择默认分类和"其他"分类下的知识库

## 9. 部署说明

- 分类管理功能作为AI管理模块的一部分，与其他功能一起部署
- 不需要额外的部署配置

## 10. 维护说明

- 定期检查分类数据的完整性
- 监控分类管理功能的性能
- 根据业务需求调整分类结构

---

**文档版本**：1.0
**创建日期**：2024-12-04
**更新日期**：2024-12-04
**创建人**：系统开发团队