# 参展公司批量导入功能说明

## 功能概述

参展公司批量导入功能为"人民城轨2.0运营管理后台"提供了高效的数据批量录入能力，支持通过Excel/CSV文件快速导入大量参展公司信息，大幅提升数据录入效率。

## 核心特性

### 🚀 完整导入流程
- **四步式导入流程**：文件上传 → 数据校验 → 确认导入 → 结果反馈
- **直观步骤指引**：清晰的进度条和状态提示
- **分阶段操作**：每一步都可以返回修改，确保数据准确性

### 📁 多格式支持
- **Excel格式**：支持 .xlsx、.xls 文件
- **CSV格式**：支持标准逗号分隔文件
- **模板下载**：提供标准模板，确保数据格式正确
- **文件限制**：单文件最大5MB，保证系统性能

### ✅ 智能数据校验
- **必填字段检查**：自动验证9个必填字段
- **格式验证**：邮箱、手机号等格式自动校验
- **重复性检查**：展位号、APP账号重复检测
- **分类验证**：公司分类必须在预定义范围内
- **批量数据冲突检查**：同批次数据内部重复检测

### 📊 详细结果反馈
- **实时统计**：总数据量、有效数据、错误数据统计
- **错误明细**：详细的错误信息和定位
- **导入结果**：成功率、失败原因统计
- **操作日志**：所有导入操作自动记录

## 使用流程

### 第一步：准备数据文件

1. **下载模板**
   - 点击"批量导入"按钮
   - 选择"下载Excel模板"或"下载CSV模板"
   - 模板包含所有必需字段和示例数据

2. **填写数据**
   - 按照模板格式填写参展公司信息
   - 确保所有必填字段都已填写
   - 检查数据格式（特别是邮箱和手机号）

### 第二步：上传文件

1. **选择文件**
   - 支持点击选择或直接拖拽上传
   - 系统自动检查文件格式和大小
   - 实时解析文件内容

2. **文件要求**
   - 格式：.csv、.xlsx、.xls
   - 大小：不超过5MB
   - 编码：UTF-8（CSV文件）

### 第三步：数据校验

1. **自动校验**
   - 系统自动验证所有数据
   - 分类显示有效数据和错误数据
   - 提供详细的错误信息

2. **校验规则**
   - 必填字段完整性检查
   - 邮箱格式：`example@domain.com`
   - 手机号格式：11位中国大陆手机号
   - 展位号、APP账号唯一性检查

### 第四步：确认导入

1. **数据预览**
   - 显示前5条有效数据预览
   - 确认数据格式正确
   - 最后确认导入操作

2. **执行导入**
   - 系统批量创建参展公司记录
   - 默认状态设置为"待审核"
   - 自动记录操作日志

### 第五步：查看结果

1. **导入统计**
   - 总处理数据量
   - 成功导入数量
   - 失败数据量
   - 导入成功率

2. **后续操作**
   - 可以选择"完成导入"返回列表
   - 可以选择"继续导入"处理更多文件

## 数据格式要求

### 必填字段（9个）

| 字段名称 | 格式要求 | 示例 | 说明 |
|---------|---------|------|------|
| 公司名称 | 文本，不超过100字符 | 中车集团 | 参展公司完整名称 |
| 公司描述 | 文本，不超过500字符 | 中国中车股份有限公司 | 公司简介 |
| 公司分类 | 预定义分类 | 车辆制造 | 必须从5个分类中选择 |
| 展位号 | 文本，格式如A区-01 | A区-01 | 展位位置标识，系统内唯一 |
| 展位规格 | 文本，格式如3x3 | 3x3 | 展位大小规格 |
| APP账号 | 文本，系统内唯一 | crrc_official | 关联的APP账号 |
| 联系人 | 文本，不超过50字符 | 张经理 | 负责人姓名 |
| 联系电话 | 11位手机号 | 13800138001 | 中国大陆手机号格式 |
| 联系邮箱 | 有效邮箱格式 | zhang@crrc.com | 标准邮箱格式 |

### 可选字段（1个）

| 字段名称 | 格式要求 | 示例 | 说明 |
|---------|---------|------|------|
| 公司网站 | 有效URL格式 | https://www.crrc.com | 公司官网地址 |

### 公司分类选项

- 车辆制造
- 智能交通
- 通信技术
- 数字化解决方案
- 信号系统

## 错误处理

### 常见错误及解决方案

1. **必填字段为空**
   - 错误信息：`公司名称不能为空`
   - 解决方案：检查并填写所有必填字段

2. **格式错误**
   - 错误信息：`邮箱格式不正确`
   - 解决方案：使用标准邮箱格式 `user@domain.com`

3. **重复数据**
   - 错误信息：`展位号已被占用`
   - 解决方案：检查展位号或APP账号是否已存在

4. **分类错误**
   - 错误信息：`公司分类不正确`
   - 解决方案：使用预定义的5个分类选项

5. **文件格式问题**
   - 错误信息：`只支持 CSV、Excel 格式的文件`
   - 解决方案：转换文件格式或重新保存

## 最佳实践

### 数据准备建议

1. **使用模板**：始终从系统下载最新模板开始
2. **分批导入**：单次建议不超过100条记录
3. **数据校验**：导入前在Excel中检查数据完整性
4. **备份数据**：导入前备份原始数据文件

### 效率提升技巧

1. **预分配展位**：提前规划展位分配避免冲突
2. **标准化数据**：统一命名规范和格式
3. **批量处理**：相同类型的公司可以批量处理
4. **错误修复**：先处理错误数据再重新导入

## 技术特性

### 安全性保障
- **数据校验**：多层次数据验证机制
- **操作日志**：完整的操作审计追踪
- **权限控制**：只有授权用户可以执行导入
- **数据备份**：导入前自动备份现有数据

### 性能优化
- **分步处理**：避免大数据量一次性处理
- **内存管理**：合理控制文件大小限制
- **异步处理**：模拟真实的后台处理过程
- **进度反馈**：实时显示处理进度

### 用户体验
- **拖拽上传**：支持直观的拖拽操作
- **步骤指引**：清晰的流程导航
- **错误提示**：详细的错误信息和建议
- **结果统计**：完整的导入结果反馈

## 注意事项

1. **数据唯一性**：展位号和APP账号必须在系统内唯一
2. **文件编码**：CSV文件建议使用UTF-8编码
3. **Excel版本**：推荐使用Excel 2010及以上版本
4. **网络稳定**：确保导入过程中网络连接稳定
5. **权限确认**：确保有参展公司管理权限

## 故障排除

### 文件上传失败
- 检查文件格式是否正确
- 确认文件大小不超过5MB
- 尝试重新保存文件

### 数据解析错误
- 检查CSV文件编码（建议UTF-8）
- 确认标题行与模板一致
- 检查数据中是否包含特殊字符

### 导入过程中断
- 刷新页面重新开始
- 检查网络连接
- 联系系统管理员

## 支持与反馈

如在使用过程中遇到问题或有改进建议，请通过以下方式联系：

- **技术支持**：系统管理员
- **功能建议**：产品团队
- **问题反馈**：通过系统内反馈功能

---

**版本信息**：v2.0  
**更新日期**：2024年1月  
**适用系统**：人民城轨2.0运营管理后台 